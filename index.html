<!-- Version 1.5.1 — Save/Load -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tier List</title>
<style>
  body { margin: 0; font-family: sans-serif; background: #222; color: #fff; }
  .tier-container { display: flex; flex-direction: column; gap: 10px; padding: 10px; }
  .tier { display: flex; align-items: center; gap: 10px; background: rgba(0,0,0,0.3); padding: 5px; border-radius: 8px; min-height: 60px; }
  .tier-label { width: 50px; text-align: center; font-weight: bold; }
  .tier-images { display: flex; flex-wrap: wrap; gap: 5px; }
  .uncategorized { background: rgba(50,50,50,0.5); min-height: 100px; padding: 10px; border-radius: 8px; }
  img { max-height: 60px; border-radius: 5px; cursor: pointer; }
  img.selected { outline: 3px solid yellow; }
  footer {
    position: fixed; bottom: 10px; right: 10px;
    background: rgba(0,0,0,0.5); padding: 6px 12px;
    border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    font-size: 0.9em; display: flex; align-items: center; gap: 8px;
  }
  .menu {
    background: rgba(30,30,30,0.8);
    border-radius: 10px; padding: 4px 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.4);
    position: relative;
  }
  .menu button {
    background: none; border: none; color: white; cursor: pointer;
    padding: 4px 8px; font-size: 0.85em; display: block; text-align: left;
    width: 100%;
  }
  .menu-content {
    display: none; position: absolute; bottom: 100%; right: 0;
    background: rgba(30,30,30,0.95); border-radius: 10px;
    overflow: hidden; min-width: 120px;
  }
  .menu:hover .menu-content { display: block; }
</style>
</head>
<body>

<div class="tier-container" id="tiers">
  <div class="tier"><div class="tier-label">20</div><div class="tier-images"></div></div>
  <div class="tier"><div class="tier-label">17</div><div class="tier-images"></div></div>
  <div class="tier"><div class="tier-label">15</div><div class="tier-images"></div></div>
  <div class="tier"><div class="tier-label">12</div><div class="tier-images"></div></div>
  <div class="uncategorized" id="uncategorized"></div>
</div>

<footer>
  <div>Version 1.5.1 — Save/Load</div>
  <div class="menu">
    ☰
    <div class="menu-content">
      <button onclick="saveTierlist()">Save Tierlist</button>
      <button onclick="document.getElementById('fileInput').click()">Load Tierlist</button>
    </div>
  </div>
</footer>

<input type="file" id="fileInput" accept=".json" style="display:none" onchange="loadTierlist(event)">

<script>
let selectedImage = null;

document.addEventListener('click', e => {
  if (e.target.tagName === 'IMG') {
    let img = e.target;
    if (img.classList.contains('selected')) {
      img.classList.remove('selected');
      selectedImage = null;
    } else if (img.closest('.tier') && !img.closest('.uncategorized')) {
      document.getElementById('uncategorized').appendChild(img);
    } else {
      document.querySelectorAll('img').forEach(i => i.classList.remove('selected'));
      img.classList.add('selected');
      selectedImage = img;
    }
  } else if (selectedImage && e.target.closest('.tier')) {
    e.target.closest('.tier').querySelector('.tier-images').appendChild(selectedImage);
    selectedImage.classList.remove('selected');
    selectedImage = null;
  }
});

function saveTierlist() {
  let data = { tiers: [], uncategorized: [], name: document.title };
  document.querySelectorAll('.tier').forEach(tier => {
    let images = [];
    tier.querySelectorAll('img').forEach(img => {
      images.push({ src: img.src });
    });
    data.tiers.push({ label: tier.querySelector('.tier-label').textContent, images });
  });
  let uncategorizedImgs = [];
  document.getElementById('uncategorized').querySelectorAll('img').forEach(img => {
    uncategorizedImgs.push({ src: img.src });
  });
  data.uncategorized = uncategorizedImgs;

  let blob = new Blob([JSON.stringify(data)], {type: 'application/json'});
  let a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'tierlist.json';
  a.click();
}

function loadTierlist(event) {
  let file = event.target.files[0];
  if (!file) return;
  let reader = new FileReader();
  reader.onload = function(e) {
    let data = JSON.parse(e.target.result);
    document.title = data.name || 'Tier List';
    document.querySelectorAll('.tier').forEach(tier => tier.querySelector('.tier-images').innerHTML = '');
    document.getElementById('uncategorized').innerHTML = '';

    data.tiers.forEach((tierData, idx) => {
      let tier = document.querySelectorAll('.tier')[idx];
      tierData.images.forEach(imgData => {
        let img = document.createElement('img');
        img.src = imgData.src;
        tier.querySelector('.tier-images').appendChild(img);
      });
    });
    data.uncategorized.forEach(imgData => {
      let img = document.createElement('img');
      img.src = imgData.src;
      document.getElementById('uncategorized').appendChild(img);
    });
  };
  reader.readAsText(file);
}
</script>

</body>
</html>
